"use strict";(self.webpackChunkonline_book_store=self.webpackChunkonline_book_store||[]).push([[866],{7866:(Yt,_,a)=>{a.r(_),a.d(_,{UserModule:()=>Nt});var d=a(9808),i=a(2382),l=a(2517),t=a(4893),h=a(1094);let Z=(()=>{class n{constructor(e,o){this.router=e,this.helperService=o}canLoad(e){return this.isAnonymous()}canActivate(e,o){return this.isAnonymous()}isAnonymous(){return!this.helperService.isLoggedIn()||(this.router.navigate(["/home"]),!1)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(l.F0),t.LFG(h.W))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})(),v=(()=>{class n{constructor(e,o){this.router=e,this.helperService=o}canLoad(e){return this.isAuthenticated()}canActivate(e,o){return this.isAuthenticated()}isAuthenticated(){return!!this.helperService.isLoggedIn()||(this.router.navigate(["/user/login"]),!1)}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(l.F0),t.LFG(h.W))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();var T=a(4408);const y=new(a(640).v)(T.o);var b=a(4482),x=a(5403),w=a(4671);function U(n,r){return n===r}var S=a(4128),I=a(2551),k=a(2073);function P(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Quantity is required "),t.qZA())}function F(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Quantity must be between 1 and 20 "),t.qZA())}function O(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Quantity must be whole Numbers "),t.qZA())}function N(n,r){if(1&n&&(t.TgZ(0,"div",29),t.YNc(1,P,2,0,"div",0),t.YNc(2,F,2,0,"div",0),t.YNc(3,O,2,0,"div",0),t.qZA()),2&n){const e=t.oxw().$implicit,o=t.oxw(2);t.xp6(1),t.Q6J("ngIf",o.getControl(e._id).errors.required),t.xp6(1),t.Q6J("ngIf",o.getControl(e._id).errors.min||o.getControl(e._id).errors.max),t.xp6(1),t.Q6J("ngIf",o.getControl(e._id).errors.pattern)}}function J(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",13),t.TgZ(1,"div",14),t.TgZ(2,"div",15),t._UZ(3,"img",16),t.qZA(),t.TgZ(4,"div",17),t.TgZ(5,"h4",18),t.TgZ(6,"strong"),t._uU(7),t.qZA(),t.qZA(),t.TgZ(8,"h4"),t.TgZ(9,"small"),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",19),t.TgZ(12,"div",20),t.TgZ(13,"h6"),t.TgZ(14,"strong"),t._uU(15),t.TgZ(16,"span",21),t._uU(17,"x"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"div",22),t.TgZ(19,"div",23),t._UZ(20,"input",24),t.qZA(),t.qZA(),t.TgZ(21,"div",25),t.TgZ(22,"button",26),t.NdJ("click",function(){const c=t.CHM(e).$implicit,m=t.oxw(2),p=t.MAs(2);return m.openRemoveModal(p,c._id)}),t._UZ(23,"i",27),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.YNc(24,N,4,3,"div",28),t.qZA()}if(2&n){const e=r.$implicit,o=t.oxw(2);t.xp6(3),t.s9C("src",e.cover,t.LSH),t.xp6(4),t.Oqu(e.title),t.xp6(3),t.Oqu(e.author),t.xp6(5),t.hij(" ",e.price," "),t.xp6(5),t.s9C("name",e._id),t.s9C("formControlName",e._id),t.xp6(4),t.Q6J("ngIf",o.getControl(e._id).invalid&&(o.getControl(e._id).dirty||o.getControl(e._id).touched))}}function Y(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",30),t.TgZ(1,"google-pay-button",31),t.NdJ("loadpaymentdata",function(s){return t.CHM(e),t.oxw(2).onSubmit(s)}),t.qZA(),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(1),t.Q6J("disabled",e.cartForm.invalid||e.cart.books.length<=0)("paymentRequest",e.paymentRequest)}}function R(n,r){if(1&n&&(t.TgZ(0,"div"),t.TgZ(1,"form",2,3),t.TgZ(3,"div",4),t.TgZ(4,"div",5),t._UZ(5,"i",6),t._uU(6," Shopping Cart "),t.TgZ(7,"div",7),t._uU(8," Total price: "),t.TgZ(9,"b"),t._uU(10),t.ALo(11,"number"),t.qZA(),t.qZA(),t._UZ(12,"div",8),t.qZA(),t.YNc(13,J,25,7,"div",9),t.TgZ(14,"div",10),t.TgZ(15,"div",7),t.YNc(16,Y,2,2,"div",11),t.TgZ(17,"a",12),t._uU(18," Continue shopping "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("formGroup",e.cartForm),t.xp6(9),t.hij("\u20b9 ",t.xi3(11,4,e.cart.totalPrice,"1.2-2"),""),t.xp6(3),t.Q6J("ngForOf",e.cart.books),t.xp6(3),t.Q6J("ngIf",!e.cart.books.length<=0)}}function Q(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",32),t.TgZ(1,"p"),t._uU(2,"Do you really want to remove this book from cart?"),t.qZA(),t.TgZ(3,"button",33),t.NdJ("click",function(){return t.CHM(e),t.oxw().onRemove()}),t._uU(4," Yes "),t.qZA(),t.TgZ(5,"button",34),t.NdJ("click",function(){return t.CHM(e),t.oxw().removeModalRef.hide()}),t._uU(6," No "),t.qZA(),t.qZA()}}let L=(()=>{class n{constructor(e,o,s,c){this.router=e,this.cartService=o,this.helperService=s,this.modalService=c}ngOnInit(){this.cartService.getCart().subscribe(e=>{this.cart=e.data,this.cartForm=this.toFormGroup(this.cart.books),this.onChanges(),this.paymentRequest={apiVersion:2,apiVersionMinor:0,allowedPaymentMethods:[{type:"CARD",parameters:{allowedAuthMethods:["PAN_ONLY","CRYPTOGRAM_3DS"],allowedCardNetworks:["MASTERCARD","VISA"]},tokenizationSpecification:{type:"PAYMENT_GATEWAY",parameters:{gateway:"example",gatewayMerchantId:"exampleGatewayMerchantId"}}}],merchantInfo:{merchantId:"17613812255336763067",merchantName:"Demo Only (you will not be charged)"},transactionInfo:{totalPriceStatus:"FINAL",totalPriceLabel:"Total",totalPrice:this.cart.totalPrice.toFixed(2),currencyCode:"INR",countryCode:"IN"}}})}ngOnDestroy(){this.changesSub$.unsubscribe()}toFormGroup(e){const o={};return e.forEach(s=>{o[s._id]=new i.NI(s.qty||"",[i.kI.required,i.kI.min(1),i.kI.max(20),i.kI.pattern("^(0|[1-9][0-9]*)$")])}),new i.cw(o)}onChanges(){this.changesSub$=this.cartForm.valueChanges.pipe(function q(n,r=y){return(0,b.e)((e,o)=>{let s=null,c=null,m=null;const p=()=>{if(s){s.unsubscribe(),s=null;const g=c;c=null,o.next(g)}};function Jt(){const g=m+n,C=r.now();if(C<g)return s=this.schedule(void 0,g-C),void o.add(s);p()}e.subscribe(new x.Q(o,g=>{c=g,m=r.now(),s||(s=r.schedule(Jt,n),o.add(s))},()=>{p(),o.complete()},void 0,()=>{c=s=null}))})}(800),function M(n,r=w.y){return n=null!=n?n:U,(0,b.e)((e,o)=>{let s,c=!0;e.subscribe(new x.Q(o,m=>{const p=r(m);(c||!n(s,p))&&(c=!1,s=p,o.next(m))}))})}()).subscribe(e=>{this.lastCartState!==JSON.stringify(e)&&(this.lastCartState=JSON.stringify(e),this.reCalcSum(e))})}openRemoveModal(e,o){this.lastDeleteId=o,this.removeModalRef=this.modalService.show(e,{class:"myModal modal-sm"})}onRemove(){this.cartService.removeFromCart(this.lastDeleteId).subscribe(()=>{this.helperService.cartStatus.next("remove"),this.cart.books=this.cart.books.filter(e=>e._id!==this.lastDeleteId),this.reCalcSum(this.cartForm.value),this.removeModalRef.hide()})}onSubmit(e){const o=e.detail;this.cart.books.length<=0||this.cartService.checkout(this.cartForm.value).subscribe(()=>{console.log(o),this.helperService.cartStatus.next("updateStatus"),this.router.navigate(["/user/purchaseHistory"])})}reCalcSum(e){let o=0;for(const s of this.cart.books)o+=s.price*e[s._id];this.cart.totalPrice=o}getControl(e){return this.cartForm.get(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.F0),t.Y36(S.N),t.Y36(h.W),t.Y36(I.tT))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-cart"]],decls:3,vars:1,consts:[[4,"ngIf"],["remove",""],[3,"formGroup"],["formDir","ngForm"],[1,"card","shopping-cart"],[1,"card-header","bg-light","text-dark"],["aria-hidden","true",1,"fa","fa-shopping-cart"],[1,"pull-right"],[1,"clearfix"],["class","card-body",4,"ngFor","ngForOf"],[1,"card-footer","bg-light"],["style","display: inline;",4,"ngIf"],["routerLink","/book/store/default",1,"btn","btn-secondary","col-sm-2"],[1,"card-body"],[1,"row"],[1,"col-12","col-sm-12","col-md-2","text-center"],["alt","cover","width","100","height","150",1,"img-responsive",3,"src"],[1,"col-12","text-sm-center","col-sm-12","text-md-left","col-md-6"],[1,"product-name"],[1,"col-12","col-sm-12","text-sm-center","col-md-4","text-md-right","row"],["id","book-price",1,"col-3","col-sm-3","col-md-6","text-md-right"],[1,"text-muted"],[1,"col-4","col-sm-4","col-md-4"],[1,"quantity"],["type","number","size","4","step","1",1,"qty",3,"name","formControlName"],[1,"col-2","col-sm-2","col-md-2","text-right"],[1,"btn","btn-outline-danger","btn-xs",3,"click"],["aria-hidden","true",1,"fa","fa-trash"],["class","alert alert-danger",4,"ngIf"],[1,"alert","alert-danger"],[2,"display","inline"],["environment","TEST","buttonType","buy","buttonSizeMode","fill",1,"btn","pull-right",3,"disabled","paymentRequest","loadpaymentdata"],[1,"modal-body","text-center"],["type","button",1,"btn","btn-default",3,"click"],["type","button",1,"btn","btn-primary",3,"click"]],template:function(e,o){1&e&&(t.YNc(0,R,19,7,"div",0),t.YNc(1,Q,7,0,"ng-template",null,1,t.W1O)),2&e&&t.Q6J("ngIf",o.cart)},directives:[d.O5,i._Y,i.JL,i.sg,d.sg,i.wV,i.Fj,i.JJ,i.u,k.x,l.yS],pipes:[d.JJ],styles:[".shopping-cart[_ngcontent-%COMP%]{font-family:Trebuchet MS,sans-serif;width:80%;margin:20px auto 240px;top:40px}.pull-right[_ngcontent-%COMP%]{margin:5px}.card-body[_ngcontent-%COMP%]{font-family:Trebuchet MS,sans-serif;background-color:#bebdbd}#book-price[_ngcontent-%COMP%]{padding-top:10px}.text-muted[_ngcontent-%COMP%]{margin-left:5px}.quantity[_ngcontent-%COMP%]{float:left;margin-right:15px;background-color:#eee;position:relative;width:80px;overflow:hidden}.quantity[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0;text-align:center;width:15px;height:15px;padding:0;float:right;color:#000;font-size:20px;border:0;outline:0;background-color:#f6f6f6}.quantity[_ngcontent-%COMP%]   input.qty[_ngcontent-%COMP%]{position:relative;border:0;width:100%;height:40px;padding:10px 25px 10px 10px;text-align:center;font-weight:400;font-size:15px;border-radius:0;background-clip:padding-box}.alert[_ngcontent-%COMP%]{width:25%;float:right;font-size:15px}"]}),n})();var D=a(7579),G=a(520);let f=(()=>{class n{constructor(e){this.http=e,this.subject=new D.x}register(e){return this.http.post("/user/register",e)}login(e){return console.log("In"),this.http.post("/user/login",e)}getProfile(e){return this.http.get("/user/profile/"+e)}getPurchaseHistory(){return this.http.get("/user/purchaseHistory")}changeAvatar(e){return this.http.post("/user/changeAvatar",e)}blockComments(e){return this.http.post("/user/blockComments/"+e,{})}unblockComments(e){return this.http.post("/user/unlockComments/"+e,{})}}return n.\u0275fac=function(e){return new(e||n)(t.LFG(G.eN))},n.\u0275prov=t.Yz7({token:n,factory:n.\u0275fac,providedIn:"root"}),n})();function W(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Username is required "),t.qZA())}function X(n,r){if(1&n&&(t.TgZ(0,"div",10),t.YNc(1,W,2,0,"div",11),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.username.errors.required)}}function K(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Password is required "),t.qZA())}function tt(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Password must be between 3 and 16 symbols "),t.qZA())}function et(n,r){if(1&n&&(t.TgZ(0,"div",10),t.YNc(1,K,2,0,"div",11),t.YNc(2,tt,2,0,"div",11),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.password.errors.required),t.xp6(1),t.Q6J("ngIf",e.password.errors.minlength||e.password.errors.maxlength)}}let nt=(()=>{class n{constructor(e,o){this.userService=e,this.router=o}ngOnInit(){this.loginForm=new i.cw({username:new i.NI("",[i.kI.required]),password:new i.NI("",[i.kI.required,i.kI.minLength(3),i.kI.maxLength(16)])})}onSubmit(){this.userService.login(this.loginForm.value).subscribe(()=>{this.router.navigate(["/home"])})}get username(){return this.loginForm.get("username")}get password(){return this.loginForm.get("password")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f),t.Y36(l.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-login"]],decls:14,vars:4,consts:[[1,"form","login-form"],[3,"formGroup","ngSubmit"],["formDir","ngForm"],[1,"form-field"],["type","text","name","username","placeholder","Username","formControlName","username",1,"username"],["aria-hidden","true",1,"fa","fa-user"],["class","input-error",4,"ngIf"],["type","password","name","password","placeholder","***","formControlName","password",1,"pass"],["aria-hidden","true",1,"fa","fa-unlock-alt"],["type","submit","value","Login",1,"submit",3,"disabled"],[1,"input-error"],[4,"ngIf"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"form",1,2),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(3,"h1"),t._uU(4,"Login Here"),t.qZA(),t.TgZ(5,"div",3),t._UZ(6,"input",4),t._UZ(7,"i",5),t.YNc(8,X,2,1,"div",6),t.qZA(),t.TgZ(9,"div",3),t._UZ(10,"input",7),t._UZ(11,"i",8),t.YNc(12,et,3,2,"div",6),t.qZA(),t._UZ(13,"input",9),t.qZA(),t.qZA()),2&e&&(t.xp6(1),t.Q6J("formGroup",o.loginForm),t.xp6(7),t.Q6J("ngIf",o.username.invalid&&(o.username.dirty||o.username.touched)),t.xp6(4),t.Q6J("ngIf",o.password.invalid&&(o.password.dirty||o.password.touched)),t.xp6(1),t.Q6J("disabled",o.loginForm.invalid))},directives:[i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,d.O5],styles:[".login-form[_ngcontent-%COMP%]{font-family:Trebuchet MS,sans-serif;margin:135px auto}"]}),n})();var ot=a(4002),rt=a(5338),it=a(9190);let st=(()=>{class n{transform(e,o){return e.length<=o?e:e.slice(0,o)+"..."}}return n.\u0275fac=function(e){return new(e||n)},n.\u0275pipe=t.Yjl({name:"shortenString",type:n,pure:!0}),n})();function at(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"div",19),t.TgZ(1,"button",20),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return s.blockComments(s.user.id)}),t._uU(2,"Block Comments"),t.qZA(),t.TgZ(3,"button",21),t.NdJ("click",function(){t.CHM(e);const s=t.oxw(2);return s.unblockComments(s.user.id)}),t._uU(4,"Unblock Comments"),t.qZA(),t.qZA()}}function ct(n,r){if(1&n&&(t.TgZ(0,"tr"),t.TgZ(1,"td"),t._uU(2),t.ALo(3,"shortenString"),t.TgZ(4,"a",24),t._uU(5),t.qZA(),t.qZA(),t.qZA()),2&n){const e=r.$implicit;t.xp6(2),t.hij(" ",t.xi3(3,3,e.content,100)," "),t.xp6(2),t.MGl("routerLink","/book/details/",e.book._id,""),t.xp6(1),t.Oqu(e.book.title)}}function dt(n,r){if(1&n&&(t.TgZ(0,"table",22),t.TgZ(1,"tbody"),t.YNc(2,ct,6,6,"tr",23),t.qZA(),t.qZA()),2&n){const e=t.oxw(2);t.xp6(2),t.Q6J("ngForOf",e.comments)}}function lt(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"h6",12),t._uU(1,"Change avatar (URL to a new image)"),t.qZA(),t.TgZ(2,"label",25),t.TgZ(3,"form",26,27),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw(2).onSubmit()}),t._UZ(5,"input",28),t._UZ(6,"input",29),t.qZA(),t.qZA()}if(2&n){const e=t.oxw(2);t.xp6(3),t.Q6J("formGroup",e.avatarForm),t.xp6(3),t.Q6J("disabled",e.avatarForm.invalid)}}function ut(n,r){if(1&n&&(t.TgZ(0,"div",3),t.TgZ(1,"div",4),t.TgZ(2,"div",5),t.TgZ(3,"div",6),t.TgZ(4,"h5",7),t._uU(5),t.qZA(),t.YNc(6,at,5,0,"div",8),t.TgZ(7,"div",9),t.TgZ(8,"div",10),t.TgZ(9,"h6"),t._uU(10,"Role"),t.qZA(),t.TgZ(11,"p"),t._uU(12),t.qZA(),t.qZA(),t.TgZ(13,"div",10),t.TgZ(14,"h6"),t._uU(15,"Comments"),t.qZA(),t.TgZ(16,"p"),t._uU(17),t.qZA(),t.qZA(),t.TgZ(18,"div",11),t.TgZ(19,"h5",12),t._UZ(20,"span",13),t._uU(21),t.qZA(),t.YNc(22,dt,3,1,"table",14),t.TgZ(23,"div",15),t._uU(24," No comments yet "),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(25,"div",16),t._UZ(26,"img",17),t.YNc(27,lt,7,2,"ng-template",18),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(5),t.hij("Username: ",e.user.username,""),t.xp6(1),t.Q6J("ngIf",e.isAdmin),t.xp6(6),t.hij(" ",e.user.isAdmin?"Admin":"User"," "),t.xp6(5),t.hij(" ",e.user.commentsCount," "),t.xp6(4),t.hij("Latest comments by ",e.user.username,""),t.xp6(1),t.Q6J("ngIf",e.comments&&e.comments.length>0),t.xp6(1),t.Q6J("hidden",e.user.commentsCount>0),t.xp6(3),t.s9C("src",e.user.avatar,t.LSH),t.xp6(1),t.Q6J("ngIf",e.currentUserId===e.user.id||e.isAdmin)}}function mt(n,r){1&n&&t._UZ(0,"app-book",33),2&n&&t.Q6J("book",r.$implicit)}function pt(n,r){if(1&n&&(t.TgZ(0,"div",30),t.TgZ(1,"h2"),t._uU(2,"Favorite Books List"),t.qZA(),t.YNc(3,mt,1,1,"app-book",31),t.TgZ(4,"div",32),t._uU(5," No books to the list yet "),t.qZA(),t.qZA()),2&n){const e=t.oxw();t.xp6(3),t.Q6J("ngForOf",e.user.favoriteBooks),t.xp6(1),t.Q6J("hidden",e.user.favoriteBooks.length>0)}}function gt(n,r){1&n&&(t.TgZ(0,"div",34),t._UZ(1,"img",35),t.qZA())}function ht(n,r){if(1&n&&(t.TgZ(0,"div",9),t.TgZ(1,"div",10),t.TgZ(2,"div",11),t._UZ(3,"img",12),t.qZA(),t.TgZ(4,"div",13),t.TgZ(5,"h4",14),t.TgZ(6,"strong"),t._uU(7),t.qZA(),t.qZA(),t.TgZ(8,"h4"),t.TgZ(9,"small"),t._uU(10),t.qZA(),t.qZA(),t.qZA(),t.TgZ(11,"div",15),t.TgZ(12,"div",16),t.TgZ(13,"h6"),t.TgZ(14,"strong"),t._uU(15),t.TgZ(16,"span",17),t._uU(17,"x"),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.TgZ(18,"div",18),t.TgZ(19,"div",19),t._UZ(20,"input",20),t.qZA(),t.qZA(),t.qZA(),t.qZA(),t.qZA()),2&n){const e=r.$implicit;t.xp6(3),t.s9C("src",e.cover,t.LSH),t.xp6(4),t.Oqu(e.title),t.xp6(3),t.Oqu(e.author),t.xp6(5),t.hij(" ",e.price," "),t.xp6(5),t.s9C("name",e._id),t.s9C("value",e.qty)}}function vt(n,r){if(1&n&&(t.TgZ(0,"div",3),t.TgZ(1,"div",4),t._UZ(2,"i",5),t._uU(3),t.TgZ(4,"div",6),t._uU(5," Total price: "),t.TgZ(6,"b"),t._uU(7),t.ALo(8,"number"),t.qZA(),t.qZA(),t._UZ(9,"div",7),t.qZA(),t.YNc(10,ht,21,6,"div",8),t.qZA()),2&n){const e=r.$implicit,o=r.index;t.xp6(3),t.hij(" Receipt ",o+1," "),t.xp6(4),t.hij("\u20b9 ",t.xi3(8,3,e.totalPrice,"1.2-2"),""),t.xp6(3),t.Q6J("ngForOf",e.productsInfo)}}function _t(n,r){if(1&n&&(t.TgZ(0,"div"),t.YNc(1,vt,11,6,"div",2),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngForOf",e.receipts)}}function Zt(n,r){1&n&&(t.TgZ(0,"div",21),t._uU(1," No receipts yet! You can visit the "),t.TgZ(2,"a",22),t._uU(3,"store"),t.qZA(),t._uU(4," to buy your first book!\n"),t.qZA())}const xt=n=>{const r=n.get("password"),e=n.get("confirmPassword");return r&&e&&r.value!==e.value?{mustMatch:!0}:null};function Ct(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Username is required "),t.qZA())}function Tt(n,r){if(1&n&&(t.TgZ(0,"div",15),t.YNc(1,Ct,2,0,"div",16),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.username.errors.required)}}function At(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Email is required "),t.qZA())}function yt(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Please provide a valid email address "),t.qZA())}function qt(n,r){if(1&n&&(t.TgZ(0,"div",15),t.YNc(1,At,2,0,"div",16),t.YNc(2,yt,2,0,"div",16),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.email.errors.required),t.xp6(1),t.Q6J("ngIf",e.email.errors.pattern)}}function wt(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Password is required "),t.qZA())}function Mt(n,r){1&n&&(t.TgZ(0,"div"),t._uU(1," Password must be between 3 and 16 symbols "),t.qZA())}function Ut(n,r){if(1&n&&(t.TgZ(0,"div",15),t.YNc(1,wt,2,0,"div",16),t.YNc(2,Mt,2,0,"div",16),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngIf",e.password.errors.required),t.xp6(1),t.Q6J("ngIf",e.password.errors.minlength||e.password.errors.maxlength)}}function St(n,r){1&n&&(t.TgZ(0,"div",15),t._uU(1," Both passwords must match "),t.qZA())}const It=/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/,kt=[{path:"",redirectTo:"login",pathMatch:"full"},{path:"profile/:username",canActivate:[v],component:(()=>{class n{constructor(e,o,s,c){this.route=e,this.commentService=o,this.userService=s,this.helperService=c}ngOnInit(){this.routeChangeSub$=this.route.params.subscribe(e=>{let o=e.username;"mine"===o&&(o=this.helperService.getProfile().username),this.userService.getProfile(o).subscribe(s=>{this.user=s.data,this.getComments()})}),this.isAdmin=this.helperService.isAdmin(),this.currentUserId=this.helperService.getProfile().id,this.avatarForm=new i.cw({avatar:new i.NI("",[i.kI.required,ot.w])})}ngOnDestroy(){this.routeChangeSub$.unsubscribe()}getComments(){this.commentService.getLatestFiveComments(this.user.id).subscribe(e=>{this.comments=e.data})}onSubmit(){this.changeUserAvatar()}changeUserAvatar(){const e=this.avatar.value;this.userService.changeAvatar({id:this.user.id,avatar:e}).subscribe(()=>{this.user.avatar=e,this.avatarForm.reset()})}blockComments(e){this.userService.blockComments(e).subscribe()}unblockComments(e){this.userService.unblockComments(e).subscribe()}get avatar(){return this.avatarForm.get("avatar")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(l.gz),t.Y36(rt.O),t.Y36(f),t.Y36(h.W))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-profile"]],decls:3,vars:3,consts:[["id","profile","class","row my-2",4,"ngIf"],["class","favorite-books",4,"ngIf"],["class","no-results",4,"ngIf"],["id","profile",1,"row","my-2"],[1,"col-lg-8","order-lg-2"],[1,"tab-content","py-4"],[1,"tab-pane","active"],[1,"mb-3"],["class","admin-panel clear-fix",4,"ngIf"],[1,"row"],[1,"col-md-6"],[1,"col-md-12"],[1,"mt-2"],[1,"fa","fa-clock-o","ion-clock","float-right"],["class","table table-sm table-hover table-striped",4,"ngIf"],[3,"hidden"],[1,"col-lg-4","order-lg-1","text-center"],["id","avatar","alt","avatar",1,"mx-auto","img-fluid","img-circle","d-block",3,"src"],[3,"ngIf"],[1,"admin-panel","clear-fix"],[1,"btn","btn-danger",3,"click"],[1,"btn","btn-success",3,"click"],[1,"table","table-sm","table-hover","table-striped"],[4,"ngFor","ngForOf"],[3,"routerLink"],[1,"custom-file"],[3,"formGroup","ngSubmit"],["formDir","ngForm"],["id","avatar-input","type","url","name","avatar","formControlName","avatar",1,"form-control"],["type","submit","value","Submit",1,"btn","btn-success",3,"disabled"],[1,"favorite-books"],[3,"book",4,"ngFor","ngForOf"],[1,"no-favorite",3,"hidden"],[3,"book"],[1,"no-results"],["src","https://i.imgur.com/KRVihMq.png","alt","no-item-found"]],template:function(e,o){1&e&&(t.YNc(0,ut,28,9,"div",0),t.YNc(1,pt,6,2,"div",1),t.YNc(2,gt,2,0,"div",2)),2&e&&(t.Q6J("ngIf",o.user),t.xp6(1),t.Q6J("ngIf",o.user),t.xp6(1),t.Q6J("ngIf",!o.user))},directives:[d.O5,d.sg,l.yS,i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,it.W],pipes:[st],styles:["#profile[_ngcontent-%COMP%]{font-family:Trebuchet MS,sans-serif;margin-top:40px!important}#avatar[_ngcontent-%COMP%]{width:150px;height:150px}#avatar-input[_ngcontent-%COMP%]{width:50%;margin:10px auto}.admin-panel[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{margin-left:5px}.favorite-books[_ngcontent-%COMP%]{font-family:Trebuchet MS,sans-serif;margin-bottom:30px}.favorite-books[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-family:Trebuchet MS,sans-serif;font-size:30px;font-weight:700}.no-favorite[_ngcontent-%COMP%]{margin-bottom:11.6em}.books-store[_ngcontent-%COMP%]{margin:30px auto}.top[_ngcontent-%COMP%]{margin-top:50px}.bottom[_ngcontent-%COMP%]{margin-bottom:50px}.book-card[_ngcontent-%COMP%]{border:5px solid transparent;display:inline-block;vertical-align:top;margin:10px;width:15%}.book-card[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:80%;height:400px}.book-card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%]{display:inline-block;font-size:19px}.book-card[_ngcontent-%COMP%]   h5[_ngcontent-%COMP%], .book-card[_ngcontent-%COMP%]   h6[_ngcontent-%COMP%], .book-card[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:10px}.book-card[_ngcontent-%COMP%]:hover{background-color:#91a3b0;border-color:#91a3b0;color:#000}"]}),n})()},{path:"purchaseHistory",canActivate:[v],component:(()=>{class n{constructor(e){this.userService=e}ngOnInit(){this.userService.getPurchaseHistory().subscribe(e=>{this.receipts=e.data})}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-receipts"]],decls:4,vars:2,consts:[[4,"ngIf"],["class","no-receipts",4,"ngIf"],["class","card shopping-cart",4,"ngFor","ngForOf"],[1,"card","shopping-cart"],[1,"card-header","bg-light","text-dark"],["aria-hidden","true",1,"fa","fa-shopping-cart"],[1,"pull-right"],[1,"clearfix"],["class","card-body",4,"ngFor","ngForOf"],[1,"card-body"],[1,"row"],[1,"col-12","col-sm-12","col-md-2","text-center"],["alt","cover","width","100","height","150",1,"img-responsive",3,"src"],[1,"col-12","text-sm-center","col-sm-12","text-md-left","col-md-6"],[1,"product-name"],[1,"col-12","col-sm-12","text-sm-center","col-md-4","text-md-right","row"],["id","book-price",1,"col-3","col-sm-3","col-md-6","text-md-right"],[1,"text-muted"],[1,"col-4","col-sm-4","col-md-4"],[1,"quantity"],["type","number","size","4","step","1","disabled","",1,"qty",3,"name","value"],[1,"no-receipts"],["routerLink","/book/store/default"]],template:function(e,o){1&e&&(t.TgZ(0,"h1"),t._uU(1,"Your Purchase Histroy"),t.qZA(),t.YNc(2,_t,2,1,"div",0),t.YNc(3,Zt,5,0,"div",1)),2&e&&(t.xp6(2),t.Q6J("ngIf",o.receipts),t.xp6(1),t.Q6J("ngIf",!o.receipts||0===o.receipts.length))},directives:[d.O5,d.sg,l.yS],pipes:[d.JJ],styles:["h1[_ngcontent-%COMP%]{margin-top:50px;font-family:Trebuchet MS,sans-serif;font-size:40px;font-weight:700;text-transform:uppercase}.shopping-cart[_ngcontent-%COMP%]{width:80%;margin:20px auto}.pull-right[_ngcontent-%COMP%]{margin:5px}.card-body[_ngcontent-%COMP%]{background-color:#b3b6b3}#book-price[_ngcontent-%COMP%]{padding-top:10px}.text-muted[_ngcontent-%COMP%]{margin-left:5px}.quantity[_ngcontent-%COMP%]{float:left;margin-right:15px;background-color:#eee;position:relative;width:80px;overflow:hidden}.quantity[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{margin:0;text-align:center;width:15px;height:15px;padding:0;float:right;color:#000;font-size:20px;border:0;outline:0;background-color:#f6f6f6}.quantity[_ngcontent-%COMP%]   input.qty[_ngcontent-%COMP%]{position:relative;border:0;width:100%;height:40px;padding:10px 25px 10px 10px;text-align:center;font-weight:400;font-size:15px;border-radius:0;background-clip:padding-box}.no-receipts[_ngcontent-%COMP%]{margin-bottom:23.5em}"]}),n})()},{path:"cart",canActivate:[v],component:L},{path:"login",canActivate:[Z],component:nt},{path:"register",canActivate:[Z],component:(()=>{class n{constructor(e,o){this.userService=e,this.router=o}ngOnInit(){this.registerForm=new i.cw({username:new i.NI("",[i.kI.required]),avatar:new i.NI(""),password:new i.NI("",[i.kI.required,i.kI.minLength(3),i.kI.maxLength(16)]),confirmPassword:new i.NI(""),email:new i.NI("",[i.kI.required,i.kI.pattern(It)])},{validators:xt})}onSubmit(){this.userService.register(this.registerForm.value).subscribe(()=>{this.router.navigate(["/home"])})}get username(){return this.registerForm.get("username")}get avatar(){return this.registerForm.get("avatar")}get password(){return this.registerForm.get("password")}get confirmPassword(){return this.registerForm.get("confirmPassword")}get email(){return this.registerForm.get("email")}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(f),t.Y36(l.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-register"]],decls:25,vars:6,consts:[[1,"form","register-form"],[3,"formGroup","ngSubmit"],["formDir","ngForm"],[1,"form-field"],["type","text","name","username","placeholder","Username","formControlName","username",1,"username"],["aria-hidden","true",1,"fa","fa-user"],["class","input-error",4,"ngIf"],["type","url","name","avatar","placeholder","Url to Avatar image (optional)","formControlName","avatar",1,"avatar"],["aria-hidden","true",1,"fas","fa-image"],["type","text","name","email","placeholder","Email","formControlName","email",1,"email"],["aria-hidden","true",1,"fa","fa-envelope"],["type","password","name","password","placeholder","***","formControlName","password",1,"pass"],["aria-hidden","true",1,"fa","fa-unlock-alt"],["type","password","name","confirmPassword","placeholder","***","formControlName","confirmPassword",1,"pass"],["type","submit","value","Register",1,"submit",3,"disabled"],[1,"input-error"],[4,"ngIf"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0),t.TgZ(1,"form",1,2),t.NdJ("ngSubmit",function(){return o.onSubmit()}),t.TgZ(3,"h1"),t._uU(4,"Register Here"),t.qZA(),t.TgZ(5,"div",3),t._UZ(6,"input",4),t._UZ(7,"i",5),t.YNc(8,Tt,2,1,"div",6),t.qZA(),t.TgZ(9,"div",3),t._UZ(10,"input",7),t._UZ(11,"i",8),t.qZA(),t.TgZ(12,"div",3),t._UZ(13,"input",9),t._UZ(14,"i",10),t.YNc(15,qt,3,2,"div",6),t.qZA(),t.TgZ(16,"div",3),t._UZ(17,"input",11),t._UZ(18,"i",12),t.YNc(19,Ut,3,2,"div",6),t.qZA(),t.TgZ(20,"div",3),t._UZ(21,"input",13),t._UZ(22,"i",12),t.YNc(23,St,2,0,"div",6),t.qZA(),t._UZ(24,"input",14),t.qZA(),t.qZA()),2&e&&(t.xp6(1),t.Q6J("formGroup",o.registerForm),t.xp6(7),t.Q6J("ngIf",o.username.invalid&&(o.username.dirty||o.username.touched)),t.xp6(7),t.Q6J("ngIf",o.email.invalid&&(o.email.dirty||o.email.touched)),t.xp6(4),t.Q6J("ngIf",o.password.invalid&&(o.password.dirty||o.password.touched)),t.xp6(4),t.Q6J("ngIf",(null==o.registerForm.errors?null:o.registerForm.errors.mustMatch)&&(o.registerForm.touched||o.registerForm.dirty)),t.xp6(1),t.Q6J("disabled",o.registerForm.invalid))},directives:[i._Y,i.JL,i.sg,i.Fj,i.JJ,i.u,d.O5],styles:[""]}),n})()}];let Pt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[l.Bz.forChild(kt)],l.Bz]}),n})();var Ft=a(9050),Ot=a(4065);let Nt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[d.ez,Ft.m,i.UX,Pt,Ot.m]]}),n})()}}]);